<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="referrer" content="never">
    <title data-rh="true">6. 优化案例探讨与总结</title>
    
    
    
    <meta name="description" content="xxx">
    <link rel="stylesheet" href="/assets/play.3ff3c1c4.css">
<link rel="stylesheet" href="/assets/client-entry.45ac381e.css">
    <script type="importmap">
      {
        "imports": {
          "react": "/react.js","react-dom": "/react-dom.js","react-dom/client": "/react-dom_client.js","react/jsx-runtime": "/react_jsx-runtime.js"
        }
      }
    </script>
  </head>
  <body>
    <div id="root"><div><header fixed="~" pos="t-0 l-0" w="full" z="10"><div flex="~" items="center" justify="between" class="h-14 divider-bottom _nav_1qmqp_22"><div><a href="/" hover="opacity-60" class="w-full h-full text-1rem font-semibold flex items-center">Nasuke.js</a></div><div flex="~"><div flex="~"><div class="text-sm font-medium mx-3"><a href="/" class="_link_1qmqp_1">主页</a></div><div class="text-sm font-medium mx-3"><a href="/guide/" class="_link_1qmqp_1">指南</a></div><div class="text-sm font-medium mx-3"><a href="/aigc/" class="_link_1qmqp_1">AI专栏</a></div></div><div before="menu-item-before" flex="~"><div __island="SwitchAppearance:0"><button class="_switch_8m5r4_1 undefined" id="" type="button" role="switch"><span class="_check_8m5r4_17"><span class="_icon_8m5r4_34"><div class="_sun_8m5r4_57"><div class="i-carbon-sun" w="full" h="full"></div></div><div class="_moon_8m5r4_61"><div class="i-carbon-moon" w="full" h="full"></div></div></span></span></button></div></div><div class="_social-link-icon_1qmqp_12" before="menu-item-before"><a href="https://github.com/Nasuke/nasuke-ssg"><div class="i-carbon-logo-github w-5 h-5 fill-current"></div></a></div></div></div></header><section style="padding-top:var(--nasuke-nav-height)"><div p="t-0 x-6 b-24 sm:6" class="_docLayout_aof7m_8"><aside class="_sidebar_1q5rk_1"><nav><section block="~" not-first="divider-top mt-4"><div flex="~" justify="between" items="center"><h2 m="t-3 b-2" text="1rem text-1" font="bold">mysql连接相关</h2></div><div mb="1"><div><div ml="5"><div p="1" block="~" text="sm" font-medium="~" class="text-text-2"><a href="/aigc/1" target="" class="_link_kjpgb_1 ">idea连接mysql数据库常见问题</a></div></div></div><div><div ml="5"><div p="1" block="~" text="sm" font-medium="~" class="text-text-2"><a href="/aigc/2" target="" class="_link_kjpgb_1 ">idea登录问题</a></div></div></div><div><div ml="5"><div p="1" block="~" text="sm" font-medium="~" class="text-text-2"><a href="/aigc/3" target="" class="_link_kjpgb_1 ">idea连接问题</a></div></div></div><div><div ml="5"><div p="1" block="~" text="sm" font-medium="~" class="text-text-2"><a href="/aigc/4" target="" class="_link_kjpgb_1 ">深度排查连接错误</a></div></div></div><div><div ml="5"><div p="1" block="~" text="sm" font-medium="~" class="text-text-2"><a href="/aigc/5" target="" class="_link_kjpgb_1 ">加速MySQL连接速度</a></div></div></div><div><div ml="5"><div p="1" block="~" text="sm" font-medium="~" class="text-text-2"><a href="/aigc/6" target="" class="_link_kjpgb_1 ">SSH隧道连</a></div></div></div></div></section><section block="~" not-first="divider-top mt-4"><div flex="~" justify="between" items="center"><h2 m="t-3 b-2" text="1rem text-1" font="bold">mysql基础知识及常见问题</h2></div><div mb="1"><div><div ml="5"><div p="1" block="~" text="sm" font-medium="~" class="text-text-2"><a href="/aigc/11" target="" class="_link_kjpgb_1 ">初探数据库魔法操作</a></div></div></div><div><div ml="5"><div p="1" block="~" text="sm" font-medium="~" class="text-text-2"><a href="/aigc/22" target="" class="_link_kjpgb_1 ">MySQL数据库创建常见误区</a></div></div></div><div><div ml="5"><div p="1" block="~" text="sm" font-medium="~" class="text-text-2"><a href="/aigc/33" target="" class="_link_kjpgb_1 ">数据类型选择技巧</a></div></div></div><div><div ml="5"><div p="1" block="~" text="sm" font-medium="~" class="text-text-2"><a href="/aigc/44" target="" class="_link_kjpgb_1 ">MySQL索引创造法宝</a></div></div></div><div><div ml="5"><div p="1" block="~" text="sm" font-medium="~" class="text-brand"><a href="/aigc/55" target="" class="_link_kjpgb_1 ">MySQL表结构设计陷阱</a></div></div></div><div><div ml="5"><div p="1" block="~" text="sm" font-medium="~" class="text-text-2"><a href="/aigc/66" target="" class="_link_kjpgb_1 ">完美数据约束与完整性</a></div></div></div></div></section><section block="~" not-first="divider-top mt-4"><div flex="~" justify="between" items="center"><h2 m="t-3 b-2" text="1rem text-1" font="bold">Linux相关</h2></div><div mb="1"><div><div ml="5"><div p="1" block="~" text="sm" font-medium="~" class="text-text-2"><a href="/aigc/1a" target="" class="_link_kjpgb_1 ">Linux内核漏洞开发修复</a></div></div></div></div></section><section block="~" not-first="divider-top mt-4"><div flex="~" justify="between" items="center"><h2 m="t-3 b-2" text="1rem text-1" font="bold">人工智能相关</h2></div><div mb="1"><div><div ml="5"><div p="1" block="~" text="sm" font-medium="~" class="text-text-2"><a href="/aigc/2a" target="" class="_link_kjpgb_1 ">文本生成介绍</a></div></div></div></div></section></nav></aside><div class="_content_aof7m_2" flex="~ 1 shrink-0" m="x-auto"><div m="x-auto" flex="~ col" class="max-w-100%"><div relative="~" m="x-auto" p="l-2" class="w-100% md:max-w-712px lg:min-w-640px"><div class="nasuke-doc"><h1 id="1-mysql表结构设计的重要性"><a class="header-anchor" href="#1-mysql表结构设计的重要性">#</a>1. MySQL表结构设计的重要性</h1>
<p>在MySQL数据库中，良好的表结构设计是确保数据库高效运行的基础。合理的表结构设计可以提高查询效率，减少数据冗余，确保数据完整性。一个好的表结构设计不仅能够提高数据库性能，还能够降低系统故障的风险。因此，在设计MySQL表结构时，需要考虑数据类型选择、主键与索引设计、规范化与反规范化等因素，以确保数据库的稳定性和高效性。</p>
<h1 id="2-mysql表结构设计要点解析"><a class="header-anchor" href="#2-mysql表结构设计要点解析">#</a>2. MySQL表结构设计要点解析</h1>
<h3 id="21-数据类型选择与优化"><a class="header-anchor" href="#21-数据类型选择与优化">#</a>2.1 数据类型选择与优化</h3>
<p>在设计MySQL表结构时，选择合适的数据类型对数据库性能和存储空间都至关重要。下面将分别介绍整数类型、浮点数类型和字符串类型的选择与优化。</p>
<h4 id="211-整数类型的选取"><a class="header-anchor" href="#211-整数类型的选取">#</a>2.1.1 整数类型的选取</h4>
<p>在MySQL中，整数类型是常用的数据类型之一，不同的整数类型在存储范围和存储空间上有所不同。一般情况下，根据实际需求选择合适的整数类型可以减少存储空间的占用，加快数据检索速度。</p>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#81A1C1">CREATE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">TABLE</span><span style="color:#D8DEE9FF"> users (</span></span>
<span class="line"><span style="color:#D8DEE9FF">    </span><span style="color:#88C0D0">user_id</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">INT</span><span style="color:#D8DEE9FF">,  </span><span style="color:#616E88">-- 使用INT类型来存储用户ID</span></span>
<span class="line"><span style="color:#D8DEE9FF">    ...</span></span>
<span class="line"><span style="color:#D8DEE9FF">);</span></span>
<span class="line"></span></code></pre></div>
<p>整数类型包括TINYINT、SMALLINT、INT和BIGINT等，根据数据范围的大小选择适当的整数类型，避免过度使用大容量的整数类型浪费空间。</p>
<h4 id="212-浮点数类型的合理运用"><a class="header-anchor" href="#212-浮点数类型的合理运用">#</a>2.1.2 浮点数类型的合理运用</h4>
<p>浮点数类型用于存储小数，包括FLOAT和DOUBLE两种常见类型。在设计表结构时，需要考虑小数位数的精度，避免存储过多的小数位导致数据精度丢失。</p>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#81A1C1">CREATE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">TABLE</span><span style="color:#D8DEE9FF"> products (</span></span>
<span class="line"><span style="color:#D8DEE9FF">    price </span><span style="color:#81A1C1">DECIMAL</span><span style="color:#D8DEE9FF">(</span><span style="color:#B48EAD">10</span><span style="color:#D8DEE9FF">, </span><span style="color:#B48EAD">2</span><span style="color:#D8DEE9FF">),  </span><span style="color:#616E88">-- 使用DECIMAL类型存储价格，保留两位小数</span></span>
<span class="line"><span style="color:#D8DEE9FF">    ...</span></span>
<span class="line"><span style="color:#D8DEE9FF">);</span></span>
<span class="line"></span></code></pre></div>
<p>根据实际需要选择合适的浮点数类型，并设置合理的精度，以确保数据准确性。</p>
<h4 id="213-字符串类型的处理"><a class="header-anchor" href="#213-字符串类型的处理">#</a>2.1.3 字符串类型的处理</h4>
<p>字符串类型在MySQL中有多种选择，包括CHAR、VARCHAR和TEXT等。在选择字符串类型时，需要考虑字段长度和存储方式，避免过度使用占用空间。</p>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#81A1C1">CREATE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">TABLE</span><span style="color:#D8DEE9FF"> articles (</span></span>
<span class="line"><span style="color:#D8DEE9FF">    title </span><span style="color:#81A1C1">VARCHAR</span><span style="color:#D8DEE9FF">(</span><span style="color:#B48EAD">100</span><span style="color:#D8DEE9FF">),  </span><span style="color:#616E88">-- 使用VARCHAR存储文章标题</span></span>
<span class="line"><span style="color:#D8DEE9FF">    content </span><span style="color:#81A1C1">TEXT</span><span style="color:#D8DEE9FF">,        </span><span style="color:#616E88">-- 使用TEXT存储文章内容</span></span>
<span class="line"><span style="color:#D8DEE9FF">    ...</span></span>
<span class="line"><span style="color:#D8DEE9FF">);</span></span>
<span class="line"></span></code></pre></div>
<p>合理选择字符串类型，并根据实际内容长度设定合适的字段长度，可以提高数据库性能。</p>
<h3 id="22-主键与索引设计"><a class="header-anchor" href="#22-主键与索引设计">#</a>2.2 主键与索引设计</h3>
<p>主键和索引是数据库中用于优化查询的重要设计元素。正确选择主键和建立适当的索引可以提高查询效率并保证数据完整性。</p>
<h4 id="221-主键的选择与唯一性"><a class="header-anchor" href="#221-主键的选择与唯一性">#</a>2.2.1 主键的选择与唯一性</h4>
<p>在设计表结构时，选择合适的主键对于数据的唯一标识和索引效率至关重要。通常情况下，使用自增主键可以有效提高查询效率。</p>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#81A1C1">CREATE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">TABLE</span><span style="color:#D8DEE9FF"> orders (</span></span>
<span class="line"><span style="color:#D8DEE9FF">    order_id </span><span style="color:#81A1C1">INT</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">PRIMARY</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">KEY</span><span style="color:#D8DEE9FF"> AUTO_INCREMENT,  </span><span style="color:#616E88">-- 使用order_id作为自增主键</span></span>
<span class="line"><span style="color:#D8DEE9FF">    ...</span></span>
<span class="line"><span style="color:#D8DEE9FF">);</span></span>
<span class="line"></span></code></pre></div>
<p>主键的选择应确保唯一性，并避免使用具有业务含义的字段作为主键，以免影响数据的准确性。</p>
<h4 id="222-索引的建立及影响"><a class="header-anchor" href="#222-索引的建立及影响">#</a>2.2.2 索引的建立及影响</h4>
<p>在MySQL中，索引可以加快数据检索的速度，提高查询性能。建立适当的索引需要考虑查询频率高的字段以及组合索引的使用情况。</p>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#81A1C1">CREATE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">INDEX</span><span style="color:#D8DEE9FF"> idx_username </span><span style="color:#81A1C1">ON</span><span style="color:#D8DEE9FF"> users(username);  </span><span style="color:#616E88">-- 为username字段创建索引</span></span>
<span class="line"></span></code></pre></div>
<p>需要注意的是，过多的索引会增加数据库的存储空间和维护成本，因此需要根据实际情况合理设计索引。</p>
<h4 id="223-合适的索引类型选择"><a class="header-anchor" href="#223-合适的索引类型选择">#</a>2.2.3 合适的索引类型选择</h4>
<p>MySQL中不同的索引类型包括普通索引、唯一索引、全文索引等。根据实际需求选择合适的索引类型可以提高查询效率。</p>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#81A1C1">CREATE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">UNIQUE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">INDEX</span><span style="color:#D8DEE9FF"> idx_email </span><span style="color:#81A1C1">ON</span><span style="color:#D8DEE9FF"> users(email);  </span><span style="color:#616E88">-- 创建唯一索引</span></span>
<span class="line"></span></code></pre></div>
<p>根据表的查询类型和业务需求，选择合适的索引类型进行优化，以提高数据库性能。</p>
<p>以上是关于MySQL表结构设计要点的解析，通过合理选择数据类型和优化主键索引设计，可以有效提升数据库性能并保证数据的完整性。接下来将进入第三章，探讨优化数据库查询性能的相关内容。</p>
<h1 id="3-优化数据库查询性能"><a class="header-anchor" href="#3-优化数据库查询性能">#</a>3. 优化数据库查询性能</h1>
<p>在数据库应用中，优化查询性能是至关重要的，能够有效提高系统的响应速度和资源利用率。本章将深入探讨如何优化数据库查询性能，包括查询语句的优化、索引优化以及处理大数据量时的优化策略。</p>
<h3 id="31-查询语句优化"><a class="header-anchor" href="#31-查询语句优化">#</a>3.1 查询语句优化</h3>
<p>在编写查询语句时，合理的语句结构和条件设计对于查询性能至关重要。下面我们将从 WHERE 条件的写法、避免使用 SELECT * 和 JOIN 使用技巧等方面来进行优化。</p>
<h4 id="311-where条件的写法"><a class="header-anchor" href="#311-where条件的写法">#</a>3.1.1 WHERE条件的写法</h4>
<p>WHERE 条件中的写法会直接影响到查询的效率，常见的写法如下：</p>
<ul>
<li>尽量避免在 WHERE 条件中对字段进行函数运算，如 <code>WHERE YEAR(create_time) = 2022</code>，这会导致全表扫描；</li>
<li>使用合适的索引列作为 WHERE 条件；</li>
<li>避免在 WHERE 条件中对字段进行类型转换，如 <code>WHERE id = &#x27;123&#x27;</code>，会导致全表扫描。</li>
</ul>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#616E88">-- 优化前</span></span>
<span class="line"><span style="color:#81A1C1">SELECT</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">*</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">FROM</span><span style="color:#D8DEE9FF"> users </span><span style="color:#81A1C1">WHERE</span><span style="color:#D8DEE9FF"> </span><span style="color:#88C0D0">YEAR</span><span style="color:#D8DEE9FF">(create_time) </span><span style="color:#81A1C1">=</span><span style="color:#D8DEE9FF"> </span><span style="color:#B48EAD">2022</span><span style="color:#D8DEE9FF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88">-- 优化后</span></span>
<span class="line"><span style="color:#81A1C1">SELECT</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">*</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">FROM</span><span style="color:#D8DEE9FF"> users </span><span style="color:#81A1C1">WHERE</span><span style="color:#D8DEE9FF"> create_time </span><span style="color:#81A1C1">&gt;=</span><span style="color:#D8DEE9FF"> </span><span style="color:#ECEFF4">&#x27;</span><span style="color:#A3BE8C">2022-01-01</span><span style="color:#ECEFF4">&#x27;</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">AND</span><span style="color:#D8DEE9FF"> create_time </span><span style="color:#81A1C1">&lt;</span><span style="color:#D8DEE9FF"> </span><span style="color:#ECEFF4">&#x27;</span><span style="color:#A3BE8C">2023-01-01</span><span style="color:#ECEFF4">&#x27;</span><span style="color:#D8DEE9FF">;</span></span>
<span class="line"></span></code></pre></div>
<h4 id="312-避免使用-select-"><a class="header-anchor" href="#312-避免使用-select-">#</a>3.1.2 避免使用 SELECT *</h4>
<p>使用 <code>SELECT *</code> 会查询表中所有字段，包括不必要的字段，增加了数据传输的开销。应该明确指定需要查询的字段。</p>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#616E88">-- 不推荐</span></span>
<span class="line"><span style="color:#81A1C1">SELECT</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">*</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">FROM</span><span style="color:#D8DEE9FF"> orders </span><span style="color:#81A1C1">WHERE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">status</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">=</span><span style="color:#D8DEE9FF"> </span><span style="color:#ECEFF4">&#x27;</span><span style="color:#A3BE8C">paid</span><span style="color:#ECEFF4">&#x27;</span><span style="color:#D8DEE9FF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88">-- 推荐</span></span>
<span class="line"><span style="color:#81A1C1">SELECT</span><span style="color:#D8DEE9FF"> order_id, order_time, total_amount </span><span style="color:#81A1C1">FROM</span><span style="color:#D8DEE9FF"> orders </span><span style="color:#81A1C1">WHERE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">status</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">=</span><span style="color:#D8DEE9FF"> </span><span style="color:#ECEFF4">&#x27;</span><span style="color:#A3BE8C">paid</span><span style="color:#ECEFF4">&#x27;</span><span style="color:#D8DEE9FF">;</span></span>
<span class="line"></span></code></pre></div>
<h4 id="313-join使用技巧"><a class="header-anchor" href="#313-join使用技巧">#</a>3.1.3 JOIN使用技巧</h4>
<p>在使用 JOIN 进行表连接时，应该注意以下几点：</p>
<ul>
<li>尽量避免在 JOIN 条件中进行函数运算，会影响索引的使用；</li>
<li>对于大表的连接，应该考虑合适的数据分页和条件过滤。</li>
</ul>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#616E88">-- 不推荐</span></span>
<span class="line"><span style="color:#81A1C1">SELECT</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">*</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">FROM</span><span style="color:#D8DEE9FF"> orders </span><span style="color:#81A1C1">JOIN</span><span style="color:#D8DEE9FF"> users </span><span style="color:#81A1C1">ON</span><span style="color:#D8DEE9FF"> orders.user_id </span><span style="color:#81A1C1">=</span><span style="color:#D8DEE9FF"> users.id </span><span style="color:#81A1C1">WHERE</span><span style="color:#D8DEE9FF"> users.status </span><span style="color:#81A1C1">=</span><span style="color:#D8DEE9FF"> </span><span style="color:#ECEFF4">&#x27;</span><span style="color:#A3BE8C">active</span><span style="color:#ECEFF4">&#x27;</span><span style="color:#D8DEE9FF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88">-- 推荐</span></span>
<span class="line"><span style="color:#81A1C1">SELECT</span><span style="color:#D8DEE9FF"> orders.order_id, orders.order_time, users.username </span></span>
<span class="line"><span style="color:#81A1C1">FROM</span><span style="color:#D8DEE9FF"> orders </span></span>
<span class="line"><span style="color:#81A1C1">JOIN</span><span style="color:#D8DEE9FF"> users </span><span style="color:#81A1C1">ON</span><span style="color:#D8DEE9FF"> orders.user_id </span><span style="color:#81A1C1">=</span><span style="color:#D8DEE9FF"> users.id </span></span>
<span class="line"><span style="color:#81A1C1">WHERE</span><span style="color:#D8DEE9FF"> users.status </span><span style="color:#81A1C1">=</span><span style="color:#D8DEE9FF"> </span><span style="color:#ECEFF4">&#x27;</span><span style="color:#A3BE8C">active</span><span style="color:#ECEFF4">&#x27;</span><span style="color:#D8DEE9FF">;</span></span>
<span class="line"></span></code></pre></div>
<h3 id="32-索引优化"><a class="header-anchor" href="#32-索引优化">#</a>3.2 索引优化</h3>
<p>索引在提高查询性能方面起着关键作用，正确地选择和使用索引能够显著减少查询时间。接下来我们将介绍了解 MySQL 索引类型、索引的创建与维护以及索引覆盖优化的相关内容。</p>
<h4 id="321-了解mysql索引类型"><a class="header-anchor" href="#321-了解mysql索引类型">#</a>3.2.1 了解MySQL索引类型</h4>
<p>MySQL中常见的索引类型包括：普通索引、唯一索引、主键索引、全文索引等。根据不同场景选择合适的索引类型。</p>
<h4 id="322-索引的创建与维护"><a class="header-anchor" href="#322-索引的创建与维护">#</a>3.2.2 索引的创建与维护</h4>
<p>在创建索引时，应该注意以下几点：</p>
<ul>
<li>为经常用于条件筛选、排序或连接的列创建索引；</li>
<li>避免创建过多的索引，会增加写操作的开销；</li>
<li>定期对索引进行维护，删除无用的索引，重建磁盘碎片化过多的索引。</li>
</ul>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#616E88">-- 创建索引</span></span>
<span class="line"><span style="color:#81A1C1">CREATE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">INDEX</span><span style="color:#D8DEE9FF"> idx_username </span><span style="color:#81A1C1">ON</span><span style="color:#D8DEE9FF"> users(username);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88">-- 维护索引</span></span>
<span class="line"><span style="color:#D8DEE9FF">ANALYZE </span><span style="color:#81A1C1">TABLE</span><span style="color:#D8DEE9FF"> users;</span></span>
<span class="line"></span></code></pre></div>
<h4 id="323-索引覆盖优化"><a class="header-anchor" href="#323-索引覆盖优化">#</a>3.2.3 索引覆盖优化</h4>
<p>索引覆盖是指查询的结果可以仅通过索引来获取，不必再回表查询数据行，减少了查询成本。</p>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#616E88">-- 索引覆盖优化</span></span>
<span class="line"><span style="color:#81A1C1">SELECT</span><span style="color:#D8DEE9FF"> order_id, order_time </span><span style="color:#81A1C1">FROM</span><span style="color:#D8DEE9FF"> orders </span><span style="color:#81A1C1">WHERE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">status</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">=</span><span style="color:#D8DEE9FF"> </span><span style="color:#ECEFF4">&#x27;</span><span style="color:#A3BE8C">paid</span><span style="color:#ECEFF4">&#x27;</span><span style="color:#D8DEE9FF">;</span></span>
<span class="line"></span></code></pre></div>
<h3 id="33-数据量大时的优化"><a class="header-anchor" href="#33-数据量大时的优化">#</a>3.3 数据量大时的优化</h3>
<p>处理大数据量的查询时，常规的优化手段已经不能满足需求，此时应该考虑分区表的使用以及水平与垂直拆分。</p>
<h4 id="331-分区表的使用"><a class="header-anchor" href="#331-分区表的使用">#</a>3.3.1 分区表的使用</h4>
<p>对于数据量大的表，可以考虑使用分区表进行存储，可以提高查询效率和减少维护成本。</p>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#616E88">-- 使用分区表</span></span>
<span class="line"><span style="color:#81A1C1">CREATE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">TABLE</span><span style="color:#D8DEE9FF"> orders (</span></span>
<span class="line"><span style="color:#D8DEE9FF">    ...</span></span>
<span class="line"><span style="color:#D8DEE9FF">) </span><span style="color:#81A1C1">PARTITION</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">BY</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">RANGE</span><span style="color:#D8DEE9FF"> (</span><span style="color:#88C0D0">YEAR</span><span style="color:#D8DEE9FF">(order_time)) (</span></span>
<span class="line"><span style="color:#D8DEE9FF">    </span><span style="color:#81A1C1">PARTITION</span><span style="color:#D8DEE9FF"> p0 </span><span style="color:#81A1C1">VALUES</span><span style="color:#D8DEE9FF"> LESS THAN (</span><span style="color:#B48EAD">2020</span><span style="color:#D8DEE9FF">),</span></span>
<span class="line"><span style="color:#D8DEE9FF">    </span><span style="color:#81A1C1">PARTITION</span><span style="color:#D8DEE9FF"> p1 </span><span style="color:#81A1C1">VALUES</span><span style="color:#D8DEE9FF"> LESS THAN (</span><span style="color:#B48EAD">2021</span><span style="color:#D8DEE9FF">),</span></span>
<span class="line"><span style="color:#D8DEE9FF">    </span><span style="color:#81A1C1">PARTITION</span><span style="color:#D8DEE9FF"> p2 </span><span style="color:#81A1C1">VALUES</span><span style="color:#D8DEE9FF"> LESS THAN (</span><span style="color:#B48EAD">2022</span><span style="color:#D8DEE9FF">)</span></span>
<span class="line"><span style="color:#D8DEE9FF">);</span></span>
<span class="line"></span></code></pre></div>
<h4 id="332-垂直与水平拆分"><a class="header-anchor" href="#332-垂直与水平拆分">#</a>3.3.2 垂直与水平拆分</h4>
<p>对于复杂的数据表，可以考虑将其拆分成多个表，减少单表的数据量；也可以将一个大表按行进行分割存储在不同的表中，减少每张表的数据量。</p>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#616E88">-- 垂直拆分</span></span>
<span class="line"><span style="color:#81A1C1">CREATE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">TABLE</span><span style="color:#D8DEE9FF"> orders_main (</span></span>
<span class="line"><span style="color:#D8DEE9FF">    order_id </span><span style="color:#81A1C1">INT</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">PRIMARY</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">KEY</span><span style="color:#D8DEE9FF">,</span></span>
<span class="line"><span style="color:#D8DEE9FF">    ...</span></span>
<span class="line"><span style="color:#D8DEE9FF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">CREATE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">TABLE</span><span style="color:#D8DEE9FF"> orders_details (</span></span>
<span class="line"><span style="color:#D8DEE9FF">    order_id </span><span style="color:#81A1C1">INT</span><span style="color:#D8DEE9FF">,</span></span>
<span class="line"><span style="color:#D8DEE9FF">    </span><span style="color:#81A1C1">FOREIGN KEY</span><span style="color:#D8DEE9FF"> (order_id) </span><span style="color:#81A1C1">REFERENCES</span><span style="color:#D8DEE9FF"> orders_main(order_id),</span></span>
<span class="line"><span style="color:#D8DEE9FF">    ...</span></span>
<span class="line"><span style="color:#D8DEE9FF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88">-- 水平拆分</span></span>
<span class="line"><span style="color:#81A1C1">CREATE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">TABLE</span><span style="color:#D8DEE9FF"> orders_2022 (</span></span>
<span class="line"><span style="color:#D8DEE9FF">    ...</span></span>
<span class="line"><span style="color:#D8DEE9FF">);</span></span>
<span class="line"></span></code></pre></div>
<p>通过对查询语句的优化、索引的优化以及处理大数据量时的优化，可以有效提升数据库的查询性能，提升系统的整体性能和用户体验。</p>
<h1 id="41-缺乏适当约束与规范"><a class="header-anchor" href="#41-缺乏适当约束与规范">#</a>4.1 缺乏适当约束与规范</h1>
<p>在进行MySQL表结构设计时，经常会出现一些缺乏适当约束与规范的情况，这可能会导致数据的不完整性和一致性问题，甚至会引发数据混乱和错误。因此，我们需要重视在设计表结构时的约束条件设置。</p>
<h4 id="411-忽视数据完整性"><a class="header-anchor" href="#411-忽视数据完整性">#</a>4.1.1 忽视数据完整性</h4>
<p>数据完整性是数据库设计中至关重要的一环，而在实际工作中，有时会因为忽视数据完整性而导致数据不完整的情况。例如，在设计用户信息表时，如果没有设置用户名字段为唯一索引，可能会导致出现多个用户使用相同用户名的问题，破坏了数据的唯一性。</p>
<p>为避免这种情况，我们在设计表结构时，应该根据实际业务需求，设置适当的约束条件和索引，确保数据的完整性和一致性。例如，在上述用户信息表中，可以通过在用户名字段上添加唯一索引，来保证用户名的唯一性。</p>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#81A1C1">CREATE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">TABLE</span><span style="color:#D8DEE9FF"> user_info (</span></span>
<span class="line"><span style="color:#D8DEE9FF">    id </span><span style="color:#81A1C1">INT</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">PRIMARY</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">KEY</span><span style="color:#D8DEE9FF">,</span></span>
<span class="line"><span style="color:#D8DEE9FF">    username </span><span style="color:#81A1C1">VARCHAR</span><span style="color:#D8DEE9FF">(</span><span style="color:#B48EAD">50</span><span style="color:#D8DEE9FF">) </span><span style="color:#81A1C1">UNIQUE</span><span style="color:#D8DEE9FF">,</span></span>
<span class="line"><span style="color:#D8DEE9FF">    </span><span style="color:#81A1C1">password</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">VARCHAR</span><span style="color:#D8DEE9FF">(</span><span style="color:#B48EAD">50</span><span style="color:#D8DEE9FF">),</span></span>
<span class="line"><span style="color:#D8DEE9FF">    email </span><span style="color:#81A1C1">VARCHAR</span><span style="color:#D8DEE9FF">(</span><span style="color:#B48EAD">50</span><span style="color:#D8DEE9FF">)</span></span>
<span class="line"><span style="color:#D8DEE9FF">);</span></span>
<span class="line"></span></code></pre></div>
<h4 id="412-约束条件的制定"><a class="header-anchor" href="#412-约束条件的制定">#</a>4.1.2 约束条件的制定</h4>
<p>除了唯一索引外，还可以通过设置外键约束、默认值约束、非空约束等方式来保证数据的完整性。在设计表结构时，要考虑到各字段之间的关联性，合理设置约束条件，避免数据之间的不一致和冲突。</p>
<p>例如，在设计订单表时，可以通过外键约束确保订单表中的用户id在用户信息表中存在，以保证订单数据的有效性。</p>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#81A1C1">CREATE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">TABLE</span><span style="color:#D8DEE9FF"> orders (</span></span>
<span class="line"><span style="color:#D8DEE9FF">    order_id </span><span style="color:#81A1C1">INT</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">PRIMARY</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">KEY</span><span style="color:#D8DEE9FF">,</span></span>
<span class="line"><span style="color:#D8DEE9FF">    </span><span style="color:#88C0D0">user_id</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">INT</span><span style="color:#D8DEE9FF">,</span></span>
<span class="line"><span style="color:#D8DEE9FF">    amount </span><span style="color:#81A1C1">DECIMAL</span><span style="color:#D8DEE9FF">(</span><span style="color:#B48EAD">10</span><span style="color:#D8DEE9FF">, </span><span style="color:#B48EAD">2</span><span style="color:#D8DEE9FF">),</span></span>
<span class="line"><span style="color:#D8DEE9FF">    </span><span style="color:#81A1C1">FOREIGN KEY</span><span style="color:#D8DEE9FF"> (</span><span style="color:#88C0D0">user_id</span><span style="color:#D8DEE9FF">) </span><span style="color:#81A1C1">REFERENCES</span><span style="color:#D8DEE9FF"> user_info(id)</span></span>
<span class="line"><span style="color:#D8DEE9FF">);</span></span>
<span class="line"></span></code></pre></div>
<p>通过合理设置约束条件，我们可以有效避免数据不完整性问题，提高数据的质量和稳定性，确保数据库系统的正常运行。</p>
<h3 id="数据表格"><a class="header-anchor" href="#数据表格">#</a>数据表格</h3>
<p>下表总结了在MySQL表结构设计过程中，常见的约束条件及其作用：</p>
<table><thead><tr><th>约束类型</th><th>作用</th></tr></thead><tbody><tr><td>唯一索引</td><td>保证字段值的唯一性</td></tr><tr><td>主键约束</td><td>唯一标识表中的每一行数据</td></tr><tr><td>外键约束</td><td>确保字段与其他表的关联性</td></tr><tr><td>默认值约束</td><td>在未指定值时自动填充默认值</td></tr><tr><td>非空约束</td><td>禁止字段的值为空</td></tr></tbody></table>
<p>通过合理使用上述约束条件，可以有效规范表结构设计，提高数据的完整性和一致性。</p>
<h3 id="mermaid流程图"><a class="header-anchor" href="#mermaid流程图">#</a>mermaid流程图</h3>
<p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="-8 -8 143 578.5" style="max-width:143px" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-0"><style>#mermaid-0{font-family:arial,sans-serif;font-size:16px;fill:#333;}#mermaid-0 .error-icon{fill:#552222;}#mermaid-0 .error-text{fill:#552222;stroke:#552222;}#mermaid-0 .edge-thickness-normal{stroke-width:2px;}#mermaid-0 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-0 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-0 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-0 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-0 .marker{fill:#333333;stroke:#333333;}#mermaid-0 .marker.cross{stroke:#333333;}#mermaid-0 svg{font-family:arial,sans-serif;font-size:16px;}#mermaid-0 .label{font-family:arial,sans-serif;color:#333;}#mermaid-0 .cluster-label text{fill:#333;}#mermaid-0 .cluster-label span,#mermaid-0 p{color:#333;}#mermaid-0 .label text,#mermaid-0 span,#mermaid-0 p{fill:#333;color:#333;}#mermaid-0 .node rect,#mermaid-0 .node circle,#mermaid-0 .node ellipse,#mermaid-0 .node polygon,#mermaid-0 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-0 .flowchart-label text{text-anchor:middle;}#mermaid-0 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-0 .node .label{text-align:center;}#mermaid-0 .node.clickable{cursor:pointer;}#mermaid-0 .arrowheadPath{fill:#333333;}#mermaid-0 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-0 .flowchart-link{stroke:#333333;fill:none;}#mermaid-0 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-0 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-0 .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#mermaid-0 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-0 .cluster text{fill:#333;}#mermaid-0 .cluster span,#mermaid-0 p{color:#333;}#mermaid-0 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-0 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-0 :root{--mermaid-font-family:arial,sans-serif;}</style><g><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="6" viewBox="0 0 10 10" class="marker flowchart" id="mermaid-0_flowchart-pointEnd"><path style="stroke-width:1;stroke-dasharray:1, 0" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart" id="mermaid-0_flowchart-pointStart"><path style="stroke-width:1;stroke-dasharray:1, 0" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart" id="mermaid-0_flowchart-circleEnd"><circle style="stroke-width:1;stroke-dasharray:1, 0" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart" id="mermaid-0_flowchart-circleStart"><circle style="stroke-width:1;stroke-dasharray:1, 0" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart" id="mermaid-0_flowchart-crossEnd"><path style="stroke-width:2;stroke-dasharray:1, 0" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart" id="mermaid-0_flowchart-crossStart"><path style="stroke-width:2;stroke-dasharray:1, 0" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid-0_flowchart-pointEnd)" style="fill:none" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" id="L-A-B-0" d="M63.5,37.5L63.5,41.667C63.5,45.833,63.5,54.167,63.5,61.617C63.5,69.067,63.5,75.633,63.5,78.917L63.5,82.2"></path><path marker-end="url(#mermaid-0_flowchart-pointEnd)" style="fill:none" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-C" id="L-B-C-0" d="M63.5,125L63.5,129.167C63.5,133.333,63.5,141.667,63.5,149.117C63.5,156.567,63.5,163.133,63.5,166.417L63.5,169.7"></path><path marker-end="url(#mermaid-0_flowchart-pointEnd)" style="fill:none" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-D" id="L-C-D-0" d="M63.5,212.5L63.5,216.667C63.5,220.833,63.5,229.167,63.5,236.617C63.5,244.067,63.5,250.633,63.5,253.917L63.5,257.2"></path><path marker-end="url(#mermaid-0_flowchart-pointEnd)" style="fill:none" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D LE-E" id="L-D-E-0" d="M63.5,300L63.5,304.167C63.5,308.333,63.5,316.667,63.5,324.117C63.5,331.567,63.5,338.133,63.5,341.417L63.5,344.7"></path><path marker-end="url(#mermaid-0_flowchart-pointEnd)" style="fill:none" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-E LE-F" id="L-E-F-0" d="M63.5,387.5L63.5,391.667C63.5,395.833,63.5,404.167,63.5,411.617C63.5,419.067,63.5,425.633,63.5,428.917L63.5,432.2"></path><path marker-end="url(#mermaid-0_flowchart-pointEnd)" style="fill:none" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-F LE-G" id="L-F-G-0" d="M63.5,475L63.5,479.167C63.5,483.333,63.5,491.667,63.5,499.117C63.5,506.567,63.5,513.133,63.5,516.417L63.5,519.7"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:inline-block;white-space:nowrap" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:inline-block;white-space:nowrap" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:inline-block;white-space:nowrap" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:inline-block;white-space:nowrap" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:inline-block;white-space:nowrap" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:inline-block;white-space:nowrap" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(63.5, 18.75)" data-id="A" data-node="true" id="flowchart-A-0" class="node default default flowchart-label"><rect height="37.5" width="47" y="-18.75" x="-23.5" ry="0" rx="0" class="basic label-container"></rect><g transform="translate(-16, -11.25)" class="label"><rect></rect><foreignObject height="22.5" width="32"><div style="display:inline-block;white-space:nowrap" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">开始</span></div></foreignObject></g></g><g transform="translate(63.5, 106.25)" data-id="B" data-node="true" id="flowchart-B-1" class="node default default flowchart-label"><rect height="37.5" width="111" y="-18.75" x="-55.5" ry="0" rx="0" class="basic label-container"></rect><g transform="translate(-48, -11.25)" class="label"><rect></rect><foreignObject height="22.5" width="96"><div style="display:inline-block;white-space:nowrap" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">设置唯一索引</span></div></foreignObject></g></g><g transform="translate(63.5, 193.75)" data-id="C" data-node="true" id="flowchart-C-3" class="node default default flowchart-label"><rect height="37.5" width="111" y="-18.75" x="-55.5" ry="0" rx="0" class="basic label-container"></rect><g transform="translate(-48, -11.25)" class="label"><rect></rect><foreignObject height="22.5" width="96"><div style="display:inline-block;white-space:nowrap" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">设置主键约束</span></div></foreignObject></g></g><g transform="translate(63.5, 281.25)" data-id="D" data-node="true" id="flowchart-D-5" class="node default default flowchart-label"><rect height="37.5" width="111" y="-18.75" x="-55.5" ry="0" rx="0" class="basic label-container"></rect><g transform="translate(-48, -11.25)" class="label"><rect></rect><foreignObject height="22.5" width="96"><div style="display:inline-block;white-space:nowrap" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">设置外键约束</span></div></foreignObject></g></g><g transform="translate(63.5, 368.75)" data-id="E" data-node="true" id="flowchart-E-7" class="node default default flowchart-label"><rect height="37.5" width="127" y="-18.75" x="-63.5" ry="0" rx="0" class="basic label-container"></rect><g transform="translate(-56, -11.25)" class="label"><rect></rect><foreignObject height="22.5" width="112"><div style="display:inline-block;white-space:nowrap" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">设置默认值约束</span></div></foreignObject></g></g><g transform="translate(63.5, 456.25)" data-id="F" data-node="true" id="flowchart-F-9" class="node default default flowchart-label"><rect height="37.5" width="111" y="-18.75" x="-55.5" ry="0" rx="0" class="basic label-container"></rect><g transform="translate(-48, -11.25)" class="label"><rect></rect><foreignObject height="22.5" width="96"><div style="display:inline-block;white-space:nowrap" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">设置非空约束</span></div></foreignObject></g></g><g transform="translate(63.5, 543.75)" data-id="G" data-node="true" id="flowchart-G-11" class="node default default flowchart-label"><rect height="37.5" width="47" y="-18.75" x="-23.5" ry="0" rx="0" class="basic label-container"></rect><g transform="translate(-16, -11.25)" class="label"><rect></rect><foreignObject height="22.5" width="32"><div style="display:inline-block;white-space:nowrap" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">结束</span></div></foreignObject></g></g></g></g></g></svg></p>
<p>以上是关于缺乏适当约束与规范可能导致的问题以及如何通过设置约束条件来规避这些问题的详细介绍。在进行MySQL表结构设计时，务必重视数据完整性和一致性，合理设置约束条件，以确保数据库系统的稳定运行。</p>
<h1 id="5-实例分析典型mysql表结构设计案例"><a class="header-anchor" href="#5-实例分析典型mysql表结构设计案例">#</a>5. 实例分析：典型MySQL表结构设计案例</h1>
<p>在前面的章节中，我们已经了解了MySQL表结构设计的重要性、设计要点的解析以及优化数据库查询性能的相关内容。接下来，我们将通过实例分析来深入探讨典型的MySQL表结构设计案例，通过实际案例的分析，加深对表结构设计的理解，并学习如何在实际项目中应用这些知识。</p>
<h3 id="51-场景介绍"><a class="header-anchor" href="#51-场景介绍">#</a>5.1 场景介绍</h3>
<p>假设我们是一家电商平台，需要设计一个用户订单管理系统。在这个系统中，涉及到用户信息、订单信息、商品信息等数据的存储和管理。接下来，我们将针对这一场景设计相应的MySQL表结构。</p>
<h3 id="52-数据库表设计"><a class="header-anchor" href="#52-数据库表设计">#</a>5.2 数据库表设计</h3>
<h4 id="521-用户信息表users"><a class="header-anchor" href="#521-用户信息表users">#</a>5.2.1 用户信息表（users）</h4>
<p>首先，我们需要设计用户信息表，用于存储用户的基本信息，例如用户ID、用户名、手机号码等。</p>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#81A1C1">CREATE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">TABLE</span><span style="color:#D8DEE9FF"> users (</span></span>
<span class="line"><span style="color:#D8DEE9FF">    </span><span style="color:#88C0D0">user_id</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">INT</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">PRIMARY</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">KEY</span><span style="color:#D8DEE9FF">,</span></span>
<span class="line"><span style="color:#D8DEE9FF">    username </span><span style="color:#81A1C1">VARCHAR</span><span style="color:#D8DEE9FF">(</span><span style="color:#B48EAD">50</span><span style="color:#D8DEE9FF">) </span><span style="color:#81A1C1">NOT</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">NULL</span><span style="color:#D8DEE9FF">,</span></span>
<span class="line"><span style="color:#D8DEE9FF">    phone </span><span style="color:#81A1C1">VARCHAR</span><span style="color:#D8DEE9FF">(</span><span style="color:#B48EAD">11</span><span style="color:#D8DEE9FF">) </span><span style="color:#81A1C1">UNIQUE</span></span>
<span class="line"><span style="color:#D8DEE9FF">);</span></span>
<span class="line"></span></code></pre></div>
<ul>
<li><code>user_id</code>：用户ID，作为主键，保证唯一性。</li>
<li><code>username</code>：用户名，限定为不为空的字符串。</li>
<li><code>phone</code>：手机号码，设置为唯一索引，保证唯一性。</li>
</ul>
<h4 id="522-订单信息表orders"><a class="header-anchor" href="#522-订单信息表orders">#</a>5.2.2 订单信息表（orders）</h4>
<p>接下来，我们设计订单信息表，用于存储用户的订单信息，包括订单ID、用户ID、订单金额等字段。</p>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#81A1C1">CREATE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">TABLE</span><span style="color:#D8DEE9FF"> orders (</span></span>
<span class="line"><span style="color:#D8DEE9FF">    order_id </span><span style="color:#81A1C1">INT</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">PRIMARY</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">KEY</span><span style="color:#D8DEE9FF">,</span></span>
<span class="line"><span style="color:#D8DEE9FF">    </span><span style="color:#88C0D0">user_id</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">INT</span><span style="color:#D8DEE9FF">,</span></span>
<span class="line"><span style="color:#D8DEE9FF">    amount </span><span style="color:#81A1C1">DECIMAL</span><span style="color:#D8DEE9FF">(</span><span style="color:#B48EAD">10</span><span style="color:#D8DEE9FF">, </span><span style="color:#B48EAD">2</span><span style="color:#D8DEE9FF">),</span></span>
<span class="line"><span style="color:#D8DEE9FF">    </span><span style="color:#81A1C1">FOREIGN KEY</span><span style="color:#D8DEE9FF"> (</span><span style="color:#88C0D0">user_id</span><span style="color:#D8DEE9FF">) </span><span style="color:#81A1C1">REFERENCES</span><span style="color:#D8DEE9FF"> users(</span><span style="color:#88C0D0">user_id</span><span style="color:#D8DEE9FF">)</span></span>
<span class="line"><span style="color:#D8DEE9FF">);</span></span>
<span class="line"></span></code></pre></div>
<ul>
<li><code>order_id</code>：订单ID，作为主键，保证唯一性。</li>
<li><code>user_id</code>：用户ID，与用户信息表关联。</li>
<li><code>amount</code>：订单金额，使用<code>DECIMAL</code>类型存储。</li>
</ul>
<h4 id="523-商品信息表products"><a class="header-anchor" href="#523-商品信息表products">#</a>5.2.3 商品信息表（products）</h4>
<p>最后，我们设计商品信息表，用于存储商品的信息，包括商品ID、商品名称、价格等。</p>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#81A1C1">CREATE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">TABLE</span><span style="color:#D8DEE9FF"> products (</span></span>
<span class="line"><span style="color:#D8DEE9FF">    product_id </span><span style="color:#81A1C1">INT</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">PRIMARY</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">KEY</span><span style="color:#D8DEE9FF">,</span></span>
<span class="line"><span style="color:#D8DEE9FF">    product_name </span><span style="color:#81A1C1">VARCHAR</span><span style="color:#D8DEE9FF">(</span><span style="color:#B48EAD">100</span><span style="color:#D8DEE9FF">) </span><span style="color:#81A1C1">NOT</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">NULL</span><span style="color:#D8DEE9FF">,</span></span>
<span class="line"><span style="color:#D8DEE9FF">    price </span><span style="color:#81A1C1">DECIMAL</span><span style="color:#D8DEE9FF">(</span><span style="color:#B48EAD">10</span><span style="color:#D8DEE9FF">, </span><span style="color:#B48EAD">2</span><span style="color:#D8DEE9FF">)</span></span>
<span class="line"><span style="color:#D8DEE9FF">);</span></span>
<span class="line"></span></code></pre></div>
<ul>
<li><code>product_id</code>：商品ID，作为主键，保证唯一性。</li>
<li><code>product_name</code>：商品名称，限定为不为空的字符串。</li>
<li><code>price</code>：商品价格，使用<code>DECIMAL</code>类型存储。</li>
</ul>
<h3 id="53-数据库表关系分析"><a class="header-anchor" href="#53-数据库表关系分析">#</a>5.3 数据库表关系分析</h3>
<p>根据上述设计，我们可以得出以下数据库表之间的关系：</p>
<ul>
<li>用户信息表（users）与订单信息表（orders）之间是一对多关系，即一个用户可以对应多个订单。</li>
<li>订单信息表（orders）与商品信息表（products）之间是多对一关系，即多个订单对应一个商品。</li>
</ul>
<h3 id="54-数据库操作示例"><a class="header-anchor" href="#54-数据库操作示例">#</a>5.4 数据库操作示例</h3>
<p>下面我们给出一个简单的数据库操作示例，展示如何向用户信息表中插入一条用户数据：</p>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#81A1C1">INSERT</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">INTO</span><span style="color:#D8DEE9FF"> users (</span><span style="color:#88C0D0">user_id</span><span style="color:#D8DEE9FF">, username, phone) </span><span style="color:#81A1C1">VALUES</span><span style="color:#D8DEE9FF"> (</span><span style="color:#B48EAD">1</span><span style="color:#D8DEE9FF">, </span><span style="color:#ECEFF4">&#x27;</span><span style="color:#A3BE8C">Alice</span><span style="color:#ECEFF4">&#x27;</span><span style="color:#D8DEE9FF">, </span><span style="color:#ECEFF4">&#x27;</span><span style="color:#A3BE8C">12345678901</span><span style="color:#ECEFF4">&#x27;</span><span style="color:#D8DEE9FF">);</span></span>
<span class="line"></span></code></pre></div>
<p>通过以上操作，我们成功向用户信息表中插入了一条用户数据，用户ID为1，用户名为Alice，手机号码为12345678901。</p>
<h3 id="表格展示"><a class="header-anchor" href="#表格展示">#</a>表格展示</h3>
<p>接下来，我们通过表格的形式展示各表的结构设计，以便更直观地查看：</p>
<table><thead><tr><th>Table Name</th><th>Columns</th></tr></thead><tbody><tr><td>users</td><td>user_id, username, phone</td></tr><tr><td>orders</td><td>order_id, user_id, amount</td></tr><tr><td>products</td><td>product_id, product_name, price</td></tr></tbody></table>
<p>在这个表格中，清晰地列出了每个表所包含的字段信息，方便查看和比对。</p>
<h3 id="总结"><a class="header-anchor" href="#总结">#</a>总结</h3>
<p>通过本实例分析，我们深入了解了典型的MySQL表结构设计案例，包括设计思路、表结构设计、表关系分析以及数据库操作示例。通过实际案例的学习，我们能更好地应用表结构设计的知识到实陃项目中，提高数据库设计的质量和效率。</p>
<p>在下一章中，我们将继续探讨优化案例，并对前面所学内容进行更深入的总结和探讨。</p>
<h1 id="6-优化案例探讨与总结"><a class="header-anchor" href="#6-优化案例探讨与总结">#</a>6. 优化案例探讨与总结</h1>
<p>在实际的MySQL表结构设计和优化过程中，经常会遇到各种性能瓶颈和问题。本章将通过一个具体的案例来展示如何优化MySQL表结构设计，以提高系统的性能和可靠性。</p>
<h3 id="优化案例背景"><a class="header-anchor" href="#优化案例背景">#</a>优化案例背景</h3>
<p>假设我们有一个在线商城系统，其中的订单表(order_table)和商品表(product_table)是系统中的两张核心表。由于订单表和商品表数据量巨大，查询频繁，现在我们需要对这两张表进行结构设计优化，以提升系统性能。</p>
<h3 id="优化案例步骤"><a class="header-anchor" href="#优化案例步骤">#</a>优化案例步骤</h3>
<h4 id="1-优化订单表order_table"><a class="header-anchor" href="#1-优化订单表order_table">#</a>1. 优化订单表(order_table)</h4>
<p>首先，我们针对订单表(order_table)进行优化。当前订单表结构如下：</p>
<table><thead><tr><th>列名</th><th>数据类型</th><th>备注</th></tr></thead><tbody><tr><td>order_id</td><td>INT</td><td>订单ID，主键</td></tr><tr><td>customer_id</td><td>INT</td><td>客户ID</td></tr><tr><td>product_id</td><td>INT</td><td>商品ID</td></tr><tr><td>amount</td><td>DECIMAL</td><td>订单金额</td></tr><tr><td>create_time</td><td>DATETIME</td><td>订单创建时间</td></tr></tbody></table>
<p>针对这个订单表，我们可以进行以下优化步骤：</p>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#616E88">-- 为订单表添加索引</span></span>
<span class="line"><span style="color:#81A1C1">CREATE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">INDEX</span><span style="color:#D8DEE9FF"> idx_customer_id </span><span style="color:#81A1C1">ON</span><span style="color:#D8DEE9FF"> order_table(customer_id);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88">-- 对订单金额字段进行数据类型调整</span></span>
<span class="line"><span style="color:#81A1C1">ALTER</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">TABLE</span><span style="color:#D8DEE9FF"> order_table </span><span style="color:#81A1C1">MODIFY</span><span style="color:#D8DEE9FF"> amount </span><span style="color:#81A1C1">DECIMAL</span><span style="color:#D8DEE9FF">(</span><span style="color:#B48EAD">10</span><span style="color:#D8DEE9FF">, </span><span style="color:#B48EAD">2</span><span style="color:#D8DEE9FF">);</span></span>
<span class="line"></span></code></pre></div>
<h4 id="2-优化商品表product_table"><a class="header-anchor" href="#2-优化商品表product_table">#</a>2. 优化商品表(product_table)</h4>
<p>接下来，我们继续对商品表(product_table)进行优化。当前商品表结构如下：</p>
<table><thead><tr><th>列名</th><th>数据类型</th><th>备注</th></tr></thead><tbody><tr><td>product_id</td><td>INT</td><td>商品ID，主键</td></tr><tr><td>product_name</td><td>VARCHAR(50)</td><td>商品名称</td></tr><tr><td>price</td><td>DECIMAL</td><td>商品价格</td></tr><tr><td>stock</td><td>INT</td><td>商品库存</td></tr><tr><td>create_time</td><td>DATETIME</td><td>商品创建时间</td></tr></tbody></table>
<p>对于商品表，我们可以执行如下优化操作：</p>
<div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre class="shiki" style="background-color:#2e3440ff"><code><span class="line"><span style="color:#616E88">-- 为商品表添加索引</span></span>
<span class="line"><span style="color:#81A1C1">CREATE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">INDEX</span><span style="color:#D8DEE9FF"> idx_product_name </span><span style="color:#81A1C1">ON</span><span style="color:#D8DEE9FF"> product_table(product_name);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88">-- 增加适当的唯一性约束</span></span>
<span class="line"><span style="color:#81A1C1">ALTER</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">TABLE</span><span style="color:#D8DEE9FF"> product_table </span><span style="color:#81A1C1">ADD</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">UNIQUE</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">INDEX</span><span style="color:#D8DEE9FF"> unique_product_name(product_name);</span></span>
<span class="line"></span></code></pre></div>
<h3 id="优化案例总结"><a class="header-anchor" href="#优化案例总结">#</a>优化案例总结</h3>
<p>通过以上优化操作，我们可以明显改善订单表和商品表的查询性能和数据完整性。在实际项目中，表结构设计的合理性和索引的合理应用是关键因素，同时避免过度冗余和不必要的字段设计也是优化的重点。</p>
<p>优化数据库表结构是一个不断优化和改进的过程，需要结合具体业务场景和实际性能需求来进行设计和调整，通过持续优化来提升系统的整体性能和稳定性。</p>
<p>以上是优化案例的探讨和总结，希望对你在实际项目中的表结构设计和优化过程有所帮助。</p></div><footer mt="8"><div flex="~" gap="2" divider-top="~" pt="6"><div flex="~ col" class="_prev_kdbcv_1"><a href="/aigc/44" class="_pager-link_kdbcv_6"><span class="_desc_kdbcv_29">上一页</span><span class="_title_kdbcv_20">MySQL索引创造法宝</span></a></div><div flex="~ col" class="_next_kdbcv_2"><a href="/aigc/66" class="_pager-link_kdbcv_6 _next_kdbcv_2"><span class="_desc_kdbcv_29">下一页</span><span class="_title_kdbcv_20">完美数据约束与完整性</span></a></div></div></footer></div></div><div relative="~" display="none lg:block" order="2" flex="1" p="l-8" class="max-w-256px"><div class="_aside-container_aof7m_32"><div flex="~ col" p="b-8" style="min-height:calc(100vh - (var(--island-nav-height-desktop) + 32px))"><div __island="Aside:1"><div flex="~ col 1" style="width:var(--nasuke-aside-width)"><div><div id="aside-container" class="relative divider-left pl-4 text-13px font-medium"><div id="aside-marker" class="absolute top-33px opacity-0 w-1px h-18px bg-brand" style="left:-1px;transition:top 0.25s cubic-bezier(0, 1, 0.5, 1), background-color 0.5s, opacity 0.25s"></div><div leading-7="~" text="13px" font="semibold">ON THIS PAGE</div><nav><ul relative="~"><li><a href="#21-数据类型选择与优化" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:12px">2.1 数据类型选择与优化</a></li><li><a href="#211-整数类型的选取" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">2.1.1 整数类型的选取</a></li><li><a href="#212-浮点数类型的合理运用" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">2.1.2 浮点数类型的合理运用</a></li><li><a href="#213-字符串类型的处理" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">2.1.3 字符串类型的处理</a></li><li><a href="#22-主键与索引设计" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:12px">2.2 主键与索引设计</a></li><li><a href="#221-主键的选择与唯一性" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">2.2.1 主键的选择与唯一性</a></li><li><a href="#222-索引的建立及影响" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">2.2.2 索引的建立及影响</a></li><li><a href="#223-合适的索引类型选择" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">2.2.3 合适的索引类型选择</a></li><li><a href="#31-查询语句优化" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:12px">3.1 查询语句优化</a></li><li><a href="#311-where条件的写法" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">3.1.1 WHERE条件的写法</a></li><li><a href="#312-避免使用-select-" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">3.1.2 避免使用 SELECT *</a></li><li><a href="#313-join使用技巧" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">3.1.3 JOIN使用技巧</a></li><li><a href="#32-索引优化" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:12px">3.2 索引优化</a></li><li><a href="#321-了解mysql索引类型" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">3.2.1 了解MySQL索引类型</a></li><li><a href="#322-索引的创建与维护" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">3.2.2 索引的创建与维护</a></li><li><a href="#323-索引覆盖优化" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">3.2.3 索引覆盖优化</a></li><li><a href="#33-数据量大时的优化" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:12px">3.3 数据量大时的优化</a></li><li><a href="#331-分区表的使用" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">3.3.1 分区表的使用</a></li><li><a href="#332-垂直与水平拆分" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">3.3.2 垂直与水平拆分</a></li><li><a href="#411-忽视数据完整性" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">4.1.1 忽视数据完整性</a></li><li><a href="#412-约束条件的制定" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">4.1.2 约束条件的制定</a></li><li><a href="#数据表格" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:12px">数据表格</a></li><li><a href="#mermaid流程图" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:12px">mermaid流程图</a></li><li><a href="#51-场景介绍" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:12px">5.1 场景介绍</a></li><li><a href="#52-数据库表设计" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:12px">5.2 数据库表设计</a></li><li><a href="#521-用户信息表users" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">5.2.1 用户信息表（users）</a></li><li><a href="#522-订单信息表orders" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">5.2.2 订单信息表（orders）</a></li><li><a href="#523-商品信息表products" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">5.2.3 商品信息表（products）</a></li><li><a href="#53-数据库表关系分析" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:12px">5.3 数据库表关系分析</a></li><li><a href="#54-数据库操作示例" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:12px">5.4 数据库操作示例</a></li><li><a href="#表格展示" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:12px">表格展示</a></li><li><a href="#总结" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:12px">总结</a></li><li><a href="#优化案例背景" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:12px">优化案例背景</a></li><li><a href="#优化案例步骤" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:12px">优化案例步骤</a></li><li><a href="#1-优化订单表order_table" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">1. 优化订单表(order_table)</a></li><li><a href="#2-优化商品表product_table" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:24px">2. 优化商品表(product_table)</a></li><li><a href="#优化案例总结" class="block leading-7 text-text-2 hover:text-text-1" transition="color duration-300" style="padding-left:12px">优化案例总结</a></li></ul></nav></div></div></div></div></div></div></div></div></div></section></div></div>
    <script type="module">import{jsxs as P,jsx as s}from"react/jsx-runtime";import{useState as U,useEffect as B,useRef as Y}from"react";const q="_check_8m5r4_17",X="_icon_8m5r4_34",z="_dark_8m5r4_29",J="_sun_8m5r4_57",K="_moon_8m5r4_61",v={switch:"_switch_8m5r4_1",check:q,icon:X,dark:z,sun:J,moon:K},I="appearance",A=(e=!1)=>{const t=document.documentElement.classList;e?t.add("dark"):t.remove("dark")},L=()=>{const e=localStorage.getItem(I);A(e==="dark")};typeof window<"u"&&typeof localStorage<"u"&&(L(),window.addEventListener("storage",L));function V(){document.documentElement.classList.contains("dark")?(A(!1),localStorage.setItem(I,"light")):(A(!0),localStorage.setItem(I,"dark"))}function Q(e){var t;return s("button",{className:`${v.switch} ${e.className}`,id:(t=e.id)!=null?t:"",type:"button",role:"switch",...e.onClick?{onClick:e.onClick}:{},children:s("span",{className:v.check,children:s("span",{className:v.icon,children:e.children})})})}function Z(e){return P(Q,{onClick:V,children:[s("div",{className:v.sun,children:s("div",{className:"i-carbon-sun",w:"full",h:"full"})}),s("div",{className:v.moon,children:s("div",{className:"i-carbon-moon",w:"full",h:"full"})})]})}var ee=typeof global=="object"&&global&&global.Object===Object&&global;const te=ee;var ne=typeof self=="object"&&self&&self.Object===Object&&self,re=te||ne||Function("return this")();const H=re;var ie=H.Symbol;const k=ie;var W=Object.prototype,oe=W.hasOwnProperty,ce=W.toString,y=k?k.toStringTag:void 0;function ae(e){var t=oe.call(e,y),r=e[y];try{e[y]=void 0;var i=!0}catch{}var l=ce.call(e);return i&&(t?e[y]=r:delete e[y]),l}var se=Object.prototype,le=se.toString;function de(e){return le.call(e)}var fe="[object Null]",ue="[object Undefined]",$=k?k.toStringTag:void 0;function me(e){return e==null?e===void 0?ue:fe:$&&$ in Object(e)?ae(e):de(e)}function ge(e){return e!=null&&typeof e=="object"}var he="[object Symbol]";function pe(e){return typeof e=="symbol"||ge(e)&&me(e)==he}var be=/\s/;function ye(e){for(var t=e.length;t--&&be.test(e.charAt(t)););return t}var ve=/^\s+/;function Te(e){return e&&e.slice(0,ye(e)+1).replace(ve,"")}function w(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var C=0/0,ke=/^[-+]0x[0-9a-f]+$/i,we=/^0b[01]+$/i,Se=/^0o[0-7]+$/i,xe=parseInt;function R(e){if(typeof e=="number")return e;if(pe(e))return C;if(w(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=w(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Te(e);var r=we.test(e);return r||Se.test(e)?xe(e.slice(2),r?2:8):ke.test(e)?C:+e}var Ee=function(){return H.Date.now()};const E=Ee;var Ie="Expected a function",Ae=Math.max,Ne=Math.min;function _e(e,t,r){var i,l,d,o,n,a,f=0,g=!1,u=!1,p=!0;if(typeof e!="function")throw new TypeError(Ie);t=R(t)||0,w(r)&&(g=!!r.leading,u="maxWait"in r,d=u?Ae(R(r.maxWait)||0,t):d,p="trailing"in r?!!r.trailing:p);function S(c){var h=i,b=l;return i=l=void 0,f=c,o=e.apply(b,h),o}function G(c){return f=c,n=setTimeout(T,t),g?S(c):o}function M(c){var h=c-a,b=c-f,O=t-h;return u?Ne(O,d-b):O}function _(c){var h=c-a,b=c-f;return a===void 0||h>=t||h<0||u&&b>=d}function T(){var c=E();if(_(c))return j(c);n=setTimeout(T,M(c))}function j(c){return n=void 0,p&&i?S(c):(i=l=void 0,o)}function D(){n!==void 0&&clearTimeout(n),f=0,i=a=l=n=void 0}function F(){return n===void 0?o:j(E())}function x(){var c=E(),h=_(c);if(i=arguments,l=this,a=c,h){if(n===void 0)return G(a);if(u)return clearTimeout(n),n=setTimeout(T,t),S(a)}return n===void 0&&(n=setTimeout(T,t)),o}return x.cancel=D,x.flush=F,x}var je="Expected a function";function Oe(e,t,r){var i=!0,l=!0;if(typeof e!="function")throw new TypeError(je);return w(r)&&(i="leading"in r?!!r.leading:i,l="trailing"in r?!!r.trailing:l),_e(e,t,{leading:i,maxWait:t,trailing:l})}let m=[];const N=56;function Le(e,t){const r=parseInt(window.getComputedStyle(e).paddingTop,10),i=window.scrollY+e.getBoundingClientRect().top+r-N;window.scrollTo({left:0,top:i,behavior:t?"smooth":"auto"})}function $e(){const e=document.getElementById("aside-marker"),t=document.getElementById("aside-container"),r=Array.from((t==null?void 0:t.getElementsByTagName("a"))||[]).map(o=>decodeURIComponent(o.hash));if(!t)return;const i=(o,n)=>{if(o[n]){const a=o[n].getAttribute("href"),f=r.findIndex(u=>u===a);(t==null?void 0:t.querySelector(`a[href="#${a.slice(1)}"]`))&&(e.style.top=`${33+f*28}px`,e.style.opacity="1")}},d=Oe(()=>{if(m=Array.from(document.querySelectorAll(".nasuke-doc .header-anchor")).filter(n=>{var a;return((a=n.parentElement)==null?void 0:a.tagName)!=="H1"}),document.documentElement.scrollTop+window.innerHeight>=document.documentElement.scrollHeight){i(m,m.length-1);return}for(let n=0;n<m.length;n++){const a=m[n],f=m[n+1],g=Math.ceil(window.scrollY),u=a.parentElement.offsetTop-N;if(!f){i(m,n);break}if(n===0&&g<u||g==0){i(m,0);break}const p=f.parentElement.offsetTop-N;if(g>=u&&g<p){i(m,n);break}}},100);return window.addEventListener("scroll",d),()=>{window.removeEventListener("scroll",d)}}function Ce(e){const[t,r]=U(e);return B(()=>{}),t}function Re(e){const{headers:t=[]}=e,r=Ce(t),i=r.length>0,l=Y(null);B(()=>{const o=$e();return()=>{o()}},[]);const d=o=>s("li",{children:s("a",{href:`#${o.id}`,className:"block leading-7 text-text-2 hover:text-text-1",transition:"color duration-300",style:{paddingLeft:(o.depth-2)*12},onClick:n=>{n.preventDefault();const a=document.getElementById(o.id);a&&Le(a,!1)},children:o.text})},o.id);return s("div",{flex:"~ col 1",style:{width:"var(--nasuke-aside-width)"},children:s("div",{children:i&&P("div",{id:"aside-container",className:"relative divider-left pl-4 text-13px font-medium",children:[s("div",{ref:l,id:"aside-marker",className:"absolute top-33px opacity-0 w-1px h-18px bg-brand",style:{left:"-1px",transition:"top 0.25s cubic-bezier(0, 1, 0.5, 1), background-color 0.5s, opacity 0.25s"}}),s("div",{"leading-7":"~",text:"13px",font:"semibold",children:"ON THIS PAGE"}),s("nav",{children:s("ul",{relative:"~",children:r.map(d)})})]})})})}window.ISLANDS={SwitchAppearance:Z,Aside:Re};window.ISLAND_PROPS=JSON.parse(document.getElementById("island-props").textContent);
</script>
    <script type="module" src="/assets/client-entry.c79f77bb.js"></script>
    <script id="island-props">[{},{"headers":[{"id":"21-数据类型选择与优化","text":"2.1 数据类型选择与优化","depth":3},{"id":"211-整数类型的选取","text":"2.1.1 整数类型的选取","depth":4},{"id":"212-浮点数类型的合理运用","text":"2.1.2 浮点数类型的合理运用","depth":4},{"id":"213-字符串类型的处理","text":"2.1.3 字符串类型的处理","depth":4},{"id":"22-主键与索引设计","text":"2.2 主键与索引设计","depth":3},{"id":"221-主键的选择与唯一性","text":"2.2.1 主键的选择与唯一性","depth":4},{"id":"222-索引的建立及影响","text":"2.2.2 索引的建立及影响","depth":4},{"id":"223-合适的索引类型选择","text":"2.2.3 合适的索引类型选择","depth":4},{"id":"31-查询语句优化","text":"3.1 查询语句优化","depth":3},{"id":"311-where条件的写法","text":"3.1.1 WHERE条件的写法","depth":4},{"id":"312-避免使用-select-","text":"3.1.2 避免使用 SELECT *","depth":4},{"id":"313-join使用技巧","text":"3.1.3 JOIN使用技巧","depth":4},{"id":"32-索引优化","text":"3.2 索引优化","depth":3},{"id":"321-了解mysql索引类型","text":"3.2.1 了解MySQL索引类型","depth":4},{"id":"322-索引的创建与维护","text":"3.2.2 索引的创建与维护","depth":4},{"id":"323-索引覆盖优化","text":"3.2.3 索引覆盖优化","depth":4},{"id":"33-数据量大时的优化","text":"3.3 数据量大时的优化","depth":3},{"id":"331-分区表的使用","text":"3.3.1 分区表的使用","depth":4},{"id":"332-垂直与水平拆分","text":"3.3.2 垂直与水平拆分","depth":4},{"id":"411-忽视数据完整性","text":"4.1.1 忽视数据完整性","depth":4},{"id":"412-约束条件的制定","text":"4.1.2 约束条件的制定","depth":4},{"id":"数据表格","text":"数据表格","depth":3},{"id":"mermaid流程图","text":"mermaid流程图","depth":3},{"id":"51-场景介绍","text":"5.1 场景介绍","depth":3},{"id":"52-数据库表设计","text":"5.2 数据库表设计","depth":3},{"id":"521-用户信息表users","text":"5.2.1 用户信息表（users）","depth":4},{"id":"522-订单信息表orders","text":"5.2.2 订单信息表（orders）","depth":4},{"id":"523-商品信息表products","text":"5.2.3 商品信息表（products）","depth":4},{"id":"53-数据库表关系分析","text":"5.3 数据库表关系分析","depth":3},{"id":"54-数据库操作示例","text":"5.4 数据库操作示例","depth":3},{"id":"表格展示","text":"表格展示","depth":3},{"id":"总结","text":"总结","depth":3},{"id":"优化案例背景","text":"优化案例背景","depth":3},{"id":"优化案例步骤","text":"优化案例步骤","depth":3},{"id":"1-优化订单表order_table","text":"1. 优化订单表(order_table)","depth":4},{"id":"2-优化商品表product_table","text":"2. 优化商品表(product_table)","depth":4},{"id":"优化案例总结","text":"优化案例总结","depth":3}]}]</script>
  </body>
</html>